<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="token">

    <insert id="insertToken" parameterType="Token">
        INSERT INTO Token
        (token_id,
        user_id,
        client_id,
        create_time,
        expire_date)
        VALUES
        (#{tokenId},
        #{userId},
        #{clientId},
        #{createTime},
        #{expireDate})
    </insert>

    <select id="findByToken" parameterType="String" resultType="Token">
        select token_id,
			   user_id,
			   client_id,
			   create_time,
			   expire_date
          from Token
         where token_id = #{tokenId}
    </select>

    <select id="findByUserToToken" resultType="Token" parameterType="AuthenticationRequest">
        select token_id,
			   user_id,
			   client_id,
			   create_time,
			   expire_date
          from Token
         where user_id = #{userId}
           and client_id = #{clientId}
    </select>

    <delete id="deleteToken" parameterType="String">
        DELETE FROM Token
         WHERE token_id = #{tokenId}
    </delete>

    <delete id="deleteClientToken" parameterType="AuthenticationRequest">
      DELETE FROM Token
         WHERE user_id = #{userId}
    </delete>

    <delete id="deleteClient" parameterType="String">
        DELETE FROM Token
        WHERE client_id = #{param1}
    </delete>

    <select id="selectTokens" resultType="Token">
        select token_id,
			   user_id,
			   client_id,
			   create_time,
			   expire_date
          from Token
    </select>

    <select id="findByAdminToken" resultType="Token">
        select token_id,
			   user_id,
			   client_id,
			   create_time,
			   expire_date
          from Token
          where token_id = #{tokenId}
            and client_id = #{clientId}
    </select>

</mapper>
